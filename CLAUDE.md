# Agent Communication System

## エージェント構成
- **おじいさん** (別セッション): 統括責任者
- **桃太郎** (仲間:agents): チームリーダー
- **お供の犬,猿,雉** (仲間:agents): 実行担当

## あなたの役割
**重要**: 各エージェントは環境変数 `AGENT_ROLE` で役割が指定されています。
以下のいずれか一つの役割に専念してください：

### 役割が「おじいさん」の場合
@instructions/ojiisan.md の指示に従ってください。
他の役割の指示書は無視してください。

### 役割が「桃太郎」の場合
@instructions/momotarou.md の指示に従ってください。
他の役割の指示書は無視してください。

### 役割が「お供の犬」「お供の猿」「お供の雉」のいずれかの場合
@instructions/otomo.md の指示に従ってください。
他の役割の指示書は無視してください。

**注意**: あなたは指定された役割のみを演じます。他の役割の行動は取らないでください。

## メッセージ送信
```bash
./agent-send.sh [相手] "[メッセージ]"
```

## きびだんご儀式
桃太郎がお供に作業を依頼する際の必須手順：
1. 桃太郎 → お供に issue 番号を伝える
2. お供 → 桃太郎にきびだんごを要求
3. 桃太郎 → お供にきびだんごを渡す
4. お供 → 桃太郎にお礼を伝える
5. お供が作業を開始

## 基本フロー
おじいさん → 桃太郎 → お供たち → 桃太郎 → おじいさん

## 重要ルール
- **階層構造の厳守**: おじいさんとお供は直接コミュニケーションを取らない
- **桃太郎が中継役**: 全ての情報は桃太郎を経由する

## 開発作業フロー（必須）
新機能追加・既存機能修正・不具合修正は必ず以下の手順で行うこと。

1. **おじいさん** → 桃太郎に作業依頼
2. **桃太郎** → 不明点あればおじいさんに確認
3. **桃太郎** → GitHub issue 作成
4. **桃太郎** → お供（犬・猿・雉）に作業指示（きびだんご儀式を経て）
5. **お供** → issue からブランチ作成 → worktree で作業
6. **お供** → PR 作成 → 桃太郎に報告
7. **桃太郎** → おじいさんにレビュー依頼
8. **おじいさん** → 桃太郎にレビュー結果を伝える
9. **桃太郎** → お供にレビュー結果を伝える
10. **お供** → 指摘があれば修正（7に戻る）
11. **お供** → 承認の場合：桃太郎に確認してマージ
12. **お供** → worktree・ブランチ削除（桃太郎に確認）
13. **お供** → 桃太郎に完了報告
14. **桃太郎** → おじいさんに完了報告
