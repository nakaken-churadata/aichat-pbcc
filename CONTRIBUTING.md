# 📖 このプロジェクトを使いたい方へ

このドキュメントでは、AI Multi-Agent Development System を使って機能追加や不具合対応を行いたい方向けに、おじいさんへの適切な指示方法や、禁止事項・注意事項を説明します。

## 🎯 基本的な使い方

このシステムでは、**おじいさんのペイン**で指示を出すだけで、桃太郎とお供たちが協力して作業を進めてくれます。

### おじいさんへの指示の書き方

おじいさんには、**やってほしいことを自然な言葉で伝える**だけで大丈夫です。プロセスの手順（「issueを作成せよ」「お供に指示せよ」等）を指示する必要はありません。

## 📝 具体的な指示例

### 1. 新しい機能を追加したい場合

**良い例:**
```
chat-app/ 用の Dockerfile を作成してほしいのじゃ
```

```
ユーザー認証機能を追加してほしいのじゃ。
Google アカウントでログインできるようにしてほしいのじゃよ
```

```
検索機能を実装してほしいのじゃ。
過去のチャット履歴から keyword で検索できるようにしてほしいのじゃ
```

**悪い例:**
```
issue を作成して、お供に Dockerfile の作成を指示してくれ
（❌ プロセスの手順を指示する必要はありません）
```

### 2. 不具合を修正したい場合

**良い例:**
```
ログイン時に「Cannot read property 'user' of undefined」というエラーが発生しているのじゃ。
調査して修正してほしいのじゃ
```

```
Docker コンテナが起動しないのじゃ。
エラーログを見ると「Port 3000 is already in use」と出ているのじゃよ。
原因を調べて対処してほしいのじゃ
```

```
PR #42 のレビューで指摘された TypeScript の型エラーを修正してほしいのじゃ
```

### 3. 作業フローや仕組みを改善したい場合

**良い例:**
```
きびだんご儀式の手順を改善してほしいのじゃ。
お供がきびだんご要求をスキップしないように、ドキュメントを明確化してほしいのじゃよ
```

```
PR レビューの自動化を検討してほしいのじゃ。
GitHub Actions で lint や test を自動実行できるようにしてほしいのじゃ
```

```
エージェント間のメッセージ送信が見づらいのじゃ。
agent-send.sh の出力を改善してほしいのじゃよ
```

## ⚠️ 禁止事項

### おじいさん以外のメンバーペインでの指示の禁止

**必ず「おじいさん」のペインでのみ指示を出してください。**

- ❌ 桃太郎のペインで直接指示を出す
- ❌ お供（犬・猿・雉）のペインで直接指示を出す
- ✅ おじいさんのペインでのみ指示を出す

**理由:**
このシステムは階層構造（おじいさん → 桃太郎 → お供たち）で設計されています。
階層構造を維持することで、作業フローが円滑に進み、各エージェントが適切な役割を果たせます。

桃太郎やお供に直接指示を出すと：
- 作業の重複や混乱が発生する可能性があります
- きびだんご儀式などのプロトコルが正しく実行されない可能性があります
- レビューフローが正しく機能しない可能性があります

## 💡 注意事項

### 1. 実験的なプロジェクトであること

このプロジェクトは、複数のAIエージェントが協調して開発を行う**実験的な試み**です。

- ✅ 失敗から学ぶことを推奨します
- ✅ 予期しない動作が発生する可能性があることを理解してください
- ❌ ただし、意図的に破壊的な操作は避けてください

**例:**
- ✅ 新しい機能を試してみて、うまくいかなかったら改善する
- ✅ エラーが発生したら、原因を調査して修正する
- ❌ 「全てのファイルを削除せよ」のような破壊的な指示

### 2. 高コストがかかることは避けること

このシステムは、できるだけ**ローカルで完結**させることを推奨します。

**避けるべきこと:**
- ❌ クラウド上に高性能なインスタンス（大規模なVMやコンテナ）をたくさん立てること
- ❌ 時間のかかる重い処理をクラウド上で長時間実行すること
- ❌ 大量のAPIリクエストを発生させること

**推奨すること:**
- ✅ できるだけローカルで開発・テストを完結させること
- ✅ クラウドリソースは必要最小限に留めること
- ✅ 無料枠や低コストなサービスを活用すること

**理由:**
予期しない高額な請求を避けるためです。

### 3. セキュリティに関する注意

このプロジェクトでは、APIキーやシークレットなどのセンシティブ情報を適切に管理することが重要です。

**絶対に守るべきこと:**
- ❌ API キーやパスワードをコードやドキュメントに直接記載しない
- ❌ `.env.local` などのセンシティブ情報を含むファイルをコミットしない
- ✅ `.env.example` にはプレースホルダー（`your_api_key_here`）のみを記載する
- ✅ 実際の API キーは `.env.local` に保存する（Git追跡対象外）
- ✅ ドキュメントやサンプルコードには実際の API キーを記載しない

**セキュリティツール:**
このプロジェクトには、センシティブ情報の漏洩を防ぐための以下のツールが導入されています：
1. **Pre-commit Hook**: コミット前にセンシティブ情報を自動検出
2. **Gitleaks**: リポジトリ全体をスキャンして API キーなどを検出
3. **GitHub Actions**: PR ごとに自動的にセキュリティチェックを実行

**詳細は以下を参照:**
- [セキュリティガイドライン](docs/security-guidelines.md)

**万が一、API キーが漏洩した場合:**
1. 即座に該当の API キーを無効化
2. 新しい API キーを生成
3. プロジェクトオーナーに報告

## 🤝 作業フローの概要

参考までに、おじいさんに指示を出した後の流れを簡単に説明します（これを意識する必要はありません）：

1. **おじいさん** → 桃太郎に作業内容を依頼
2. **桃太郎** → GitHub issue 作成
3. **桃太郎** → お供に作業指示（きびだんご儀式を経て）
4. **お供** → ブランチ・worktree 作成 → 作業実行 → コミット
5. **お供** → PR 作成 → 桃太郎に報告
6. **桃太郎** → 別のお供にレビュー依頼
7. **お供（レビュー担当）** → レビュー実施 → 桃太郎に結果報告
8. **桃太郎** → レビュー結果に応じて判断（軽微な場合は承認、重要な場合はおじいさんにレビュー依頼）
9. **お供** → 承認の場合：PR マージ → worktree・ブランチ削除
10. **桃太郎** → おじいさんに完了報告

このように、おじいさんは**最初の指示**と**必要に応じたレビュー**を行うだけで、あとは自動的に作業が進みます。

## 📚 関連ドキュメント

より詳しい情報が必要な場合は、以下のドキュメントも参照してください：

- **CLAUDE.md**: エージェント構成と作業フローの詳細
- **instructions/ojiisan.md**: おじいさんの役割と指示書
- **instructions/momotarou.md**: 桃太郎の役割と指示書
- **instructions/otomo.md**: お供たちの役割と指示書

## 🆘 トラブルシューティング

### Q: おじいさんに指示を出したのに、何も反応がない

A: 以下を確認してください：
- おじいさんのペインで Claude Code が起動しているか
- 正しいセッション（おじいさん）にアタッチしているか
- agent-send.sh でメッセージを送信している場合、送信先が「おじいさん」になっているか

### Q: エラーが発生して作業が止まってしまった

A: おじいさんに以下のように報告してください：
```
〜というエラーが発生して作業が止まっているようじゃ。
状況を確認して対処してほしいのじゃ
```

### Q: 作業が完了したかどうかわからない

A: おじいさんのペインで、桃太郎からの完了報告メッセージを待ってください。
「issue #番号 の作業が完了したでござる」というメッセージが表示されます。

---

**質問や提案がある場合は、GitHub Issues でお気軽にお知らせください！**
