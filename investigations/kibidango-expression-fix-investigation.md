# きびだんご儀式の表現修正に関連する issue の調査結果

## 概要
本ドキュメントは、以前行われた「きびだんご儀式の表現修正」に関連する issue と PR を調査した結果をまとめたものである。

## 調査結果サマリー

きびだんご儀式の表現修正に関連する issue は **3件** 見つかった。

これらの issue は、「要求」という曖昧な表現を「agent-send.sh を実行する」という明確な表現に直すとともに、お供の自律性を高め、作業フローを簡略化することを目的としていた。

## 関連する issue と PR

### 1. issue #37: 指示書の改善：きびだんご儀式と役割確認の明確化

#### 基本情報
- **issue 番号**: #37
- **タイトル**: 指示書の改善：きびだんご儀式と役割確認の明確化
- **状態**: CLOSED
- **作成日**: 2026-02-13
- **関連 PR**: #38
- **PR タイトル**: fix: きびだんご儀式と作業フローの明確化
- **PR 状態**: MERGED

#### 主な内容
役割を忘れる問題ときびだんご要求のスキップ問題を解決するため、指示書を改善した。

**背景の問題**:
- きびだんご儀式の「目的」が不明確
- お供の作業フローで時間的優先順位が不明確
- 桃太郎からの指示メッセージで次のアクションが明示されていない

**変更内容**:
1. **CLAUDE.md の改善**: きびだんご儀式の目的を追加（作業開始の明確化、信頼関係構築、作業の正式な開始の確認）
2. **instructions/otomo.md の改善**: 作業フローを時系列で明確化（ステップ1, 2, 3）、issue 確認よりもきびだんご儀式が優先されることを明記
3. **instructions/momotarou.md の改善**: 作業指示メッセージに「まず、きびだんごを要求してくだされ」を追加

**期待される効果**:
- きびだんご儀式のスキップを防止
- 作業フローの理解向上
- 認識ずれの防止
- 信頼関係の強化

#### 表現修正の例
**変更前** (otomo.md):
```
桃太郎から issue 番号の連絡を受けたら、**必ず agent-send.sh できびだんご儀式を行う**（詳細はCLAUDE.md参照）。
```

**変更後** (otomo.md):
```
桃太郎から issue 番号の連絡を受けたら、**即座に**以下のステップを実行すること：

**重要**: issue の確認や他の作業は後回し。まず最初にきびだんご儀式を完了すること。

**ステップ1**: きびだんごを要求（最優先、即座に実行）
**ステップ2**: きびだんごを受け取ったらお礼
**ステップ3**: この時点で初めて issue を確認して作業を開始
```

---

### 2. issue #48: きびだんご儀式の改善：お供が自発的にきびだんごを要求する仕組みに変更

#### 基本情報
- **issue 番号**: #48
- **タイトル**: きびだんご儀式の改善：お供が自発的にきびだんごを要求する仕組みに変更
- **状態**: CLOSED
- **作成日**: 2026-02-14
- **関連 PR**: #49
- **PR タイトル**: feat: きびだんご儀式の改善 - お供が自発的にきびだんごを要求する仕組みに変更
- **PR 状態**: MERGED

#### 主な内容
お供の自律性を高め、桃太郎が明示的に指示しなくても確実にきびだんご儀式が実行されるように改善した。

**背景の問題**:
- 桃太郎が明示的に「まず、きびだんごを要求してくだされ」と指示する必要がある
- 桃太郎がこの指示を忘れると、お供がきびだんご要求をスキップする可能性がある

**変更内容**:
1. **CLAUDE.md**: お供が「桃太郎からの明示的な指示がなくても」自発的にきびだんごを要求することを明記
2. **instructions/momotarou.md**: お供への作業指示例から「まず、きびだんごを要求してくだされ」を削除、お供は自発的に要求することを説明
3. **instructions/otomo.md**: 「絶対的なルール」セクションを追加、桃太郎が「きびだんごを要求してくだされ」と言わなくても自発的に要求することを明記

**期待される効果**:
- お供が自律的にきびだんご儀式を実行
- 桃太郎の指示忘れによるスキップを防止
- きびだんご儀式の確実な実行
- 作業フローのシンプル化

#### 表現修正の例
**変更前** (momotarou.md):
```bash
./agent-send.sh お供の犬 "issue #番号 の作業を頼みたいでござる。まず、きびだんごを要求してくだされ"
```

**変更後** (momotarou.md):
```bash
./agent-send.sh お供の犬 "issue #番号 の作業を頼みたいでござる"
# お供は自発的にきびだんごを要求する
```

**追加** (otomo.md):
```
**絶対的なルール**: 桃太郎から issue 番号の連絡を受けたら、桃太郎が「きびだんごを要求してくだされ」と言わなくても、**必ず自発的に**きびだんごを要求すること。これは例外なく実行すべき最優先事項である。
```

---

### 3. issue #50: お供の作業フロー改善：クローズ処理の確認を簡略化

#### 基本情報
- **issue 番号**: #50
- **タイトル**: お供の作業フロー改善：クローズ処理の確認を簡略化
- **状態**: CLOSED
- **作成日**: 2026-02-14
- **関連 PR**: #51
- **PR タイトル**: refactor: クローズ処理の確認を簡略化
- **PR 状態**: MERGED

#### 主な内容
お供が桃太郎から PR のマージとクローズ処理の指示を受けた時、各ステップで桃太郎に確認を取る仕組みから、確認なしで一連の作業を実行する仕組みに変更した。

**背景の問題**:
- 桃太郎が「PR をマージしてクローズ処理を進めてくだされ」と指示
- お供が各ステップ（マージ・worktree削除・ブランチ削除）で桃太郎に確認
- 桃太郎が毎回許可を出す必要があり、作業が煩雑

**変更内容**:
1. **instructions/otomo.md**: 桃太郎の「PR をマージしてクローズ処理を進めてくだされ」が承認を意味することを明記、確認なしで一連の作業を自律的に実行
2. **instructions/momotarou.md**: お供が確認なしで作業を実行することを説明
3. **CLAUDE.md**: 「桃太郎に確認してクローズ処理」→「確認なしでクローズ処理を実行」に変更

**期待される効果**:
- 作業フローの簡略化（3回の確認 → 0回）
- 作業効率の向上
- お供の自律性を高める
- 桃太郎の負担軽減

#### 表現修正の例
**変更前** (otomo.md):
```markdown
桃太郎から承認を受けたら、以下を順番に実行する（**各操作前に必ず agent-send.sh で桃太郎に確認**）：

1. **マージ前の確認**
   ```bash
   ./agent-send.sh 桃太郎 "PR をマージしてよろしいでしょうかワン？"
   ```
2. プルリクエストをno-ffマージ
3. **worktree 削除前の確認**
   （省略）
```

**変更後** (otomo.md):
```markdown
桃太郎から「PR をマージしてクローズ処理を進めてくだされ」という指示を受けたら、これは承認を意味するため、**確認なしで**以下を順番に実行する：

1. プルリクエストをno-ffマージ
2. worktree を削除
3. ブランチを削除
4. **完了報告**（必須）

**重要**: 桃太郎から「クローズ処理を進めてくだされ」と指示された時点で、既に承認されているため、各ステップでの確認は不要。自律的に作業を完了すること。
```

---

## 表現修正の共通パターン

調査の結果、以下の共通パターンが見つかった：

### パターン 1: 曖昧な「要求」→ 明確な「agent-send.sh 実行」
**目的**: 作業フローの明確化、実行手段の具体化

**変更前**:
- 「きびだんご儀式を行う」
- 「きびだんごを要求する」

**変更後**:
- 「以下のステップを実行すること」+ 具体的な agent-send.sh のコマンド例
- 「agent-send.sh で桃太郎にきびだんごを要求」

### パターン 2: 受動的な実行 → 自発的・自律的な実行
**目的**: お供の自律性向上、桃太郎の負担軽減

**変更前**:
- 桃太郎が「きびだんごを要求してくだされ」と明示的に指示
- お供が各ステップで桃太郎に確認

**変更後**:
- お供が自発的にきびだんごを要求（桃太郎からの指示不要）
- お供が確認なしで一連の作業を実行

### パターン 3: 曖昧な優先順位 → 明確な時系列
**目的**: 作業の順序を明確化、スキップ防止

**変更前**:
- 「きびだんご儀式を行う」（いつ行うかが不明確）

**変更後**:
- 「**即座に**以下のステップを実行すること」
- 「**ステップ1**: きびだんごを要求（最優先、即座に実行）」
- 「**重要**: issue の確認や他の作業は後回し」

## 結論

以前行われた可能性のある、きびだんご儀式の表現修正に関連する issue は **3件（#37, #48, #50）** 見つかった。

これらの issue では、以下の改善が行われた：

1. **表現の明確化**: 「要求」という曖昧な表現を「agent-send.sh を実行する」という具体的な表現に変更
2. **自律性の向上**: お供が自発的に作業を実行する仕組みを導入
3. **作業フローの簡略化**: 不要な確認を削減し、効率化を実現
4. **時系列の明確化**: ステップを番号付けし、優先順位を明確化

これらの改善により、作業フローが明確化され、お供の自律性が高まり、桃太郎の負担が軽減された。

## 参考資料

### 関連 issue
- [issue #37: 指示書の改善：きびだんご儀式と役割確認の明確化](https://github.com/nakaken-churadata/aichat-pbcc/issues/37)
- [issue #48: きびだんご儀式の改善：お供が自発的にきびだんごを要求する仕組みに変更](https://github.com/nakaken-churadata/aichat-pbcc/issues/48)
- [issue #50: お供の作業フロー改善：クローズ処理の確認を簡略化](https://github.com/nakaken-churadata/aichat-pbcc/issues/50)

### 関連 PR
- [PR #38: fix: きびだんご儀式と作業フローの明確化](https://github.com/nakaken-churadata/aichat-pbcc/pull/38)
- [PR #49: feat: きびだんご儀式の改善 - お供が自発的にきびだんごを要求する仕組みに変更](https://github.com/nakaken-churadata/aichat-pbcc/pull/49)
- [PR #51: refactor: クローズ処理の確認を簡略化](https://github.com/nakaken-churadata/aichat-pbcc/pull/51)
